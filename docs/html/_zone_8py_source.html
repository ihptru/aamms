<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Armagetron MultiModeScript: Zone.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Zone.py</h1>  </div>
</div>
<div class="contents">
<a href="_zone_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespace_zone.html">00001</a> <span class="comment">## @file Zone.py</span>
<a name="l00002"></a>00002  <span class="comment"># @package Zone</span>
<a name="l00003"></a>00003  <span class="comment"># @brief Functions and classes for zone management</span>
<a name="l00004"></a>00004  <span class="comment"># @details This file contains functions and classes that are used for zone management.</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">from</span> Armagetronad <span class="keyword">import</span> *
<a name="l00007"></a>00007 <span class="keyword">import</span> Armagetronad
<a name="l00008"></a>00008 <span class="keyword">import</span> Event
<a name="l00009"></a>00009 <span class="keyword">import</span> logging
<a name="l00010"></a>00010 <span class="keyword">import</span> logging.handlers
<a name="l00011"></a>00011 <span class="keyword">import</span> Team
<a name="l00012"></a>00012 <span class="keyword">import</span> yaml
<a name="l00013"></a>00013 <span class="keyword">import</span> time
<a name="l00014"></a>00014 <span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process <span class="keyword">as</span> Thread
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keywordflow">if</span> <span class="stringliteral">&quot;log&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> dir():
<a name="l00017"></a>00017         <span class="comment">## @brief The logging object</span>
<a name="l00018"></a>00018          <span class="comment"># @private</span>
<a name="l00019"></a>00019          <span class="comment"># @details Used for logging by this module</span>
<a name="l00020"></a>00020          <span class="comment"># @note To enable or disable logging of this module use \link Team.enableLogging\endlink</span>
<a name="l00021"></a><a class="code" href="namespace_zone.html#aad90704d2c88929bd92b7acf2b9a09d6">00021</a>         log=logging.getLogger(<span class="stringliteral">&quot;TeamModule&quot;</span>)
<a name="l00022"></a>00022         log.addHandler(logging.NullHandler() )
<a name="l00023"></a>00023 
<a name="l00024"></a>00024         <span class="comment">## @brief All avaliable zone types</span>
<a name="l00025"></a>00025          <span class="comment"># @details List of all avaliable zone types used to determine if a zone type is valid.</span>
<a name="l00026"></a><a class="code" href="namespace_zone.html#a8dcf5d84aac63b42f1ce7684c3b4ea91">00026</a>         _ZONE_TYPES=[<span class="stringliteral">&quot;win&quot;</span>, <span class="stringliteral">&quot;death&quot;</span>, <span class="stringliteral">&quot;ball&quot;</span>, <span class="stringliteral">&quot;ballTeam&quot;</span>, <span class="stringliteral">&quot;blast&quot;</span>, <span class="stringliteral">&quot;deathTeam&quot;</span>, <span class="stringliteral">&quot;koh&quot;</span>, 
<a name="l00027"></a>00027                          <span class="stringliteral">&quot;fortress&quot;</span>, <span class="stringliteral">&quot;flag&quot;</span>,<span class="stringliteral">&quot;rubber&quot;</span>, <span class="stringliteral">&quot;sumo&quot;</span>, <span class="stringliteral">&quot;target&quot;</span>, <span class="stringliteral">&quot;teleport&quot;</span>, <span class="stringliteral">&quot;zombie&quot;</span>,
<a name="l00028"></a>00028                          <span class="stringliteral">&quot;zombieOwner&quot;</span>]
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="comment">## @brief All zone types that are for def.</span>
<a name="l00031"></a>00031          <span class="comment"># @details List of zone types you don&#39;t need when you attack.</span>
<a name="l00032"></a><a class="code" href="namespace_zone.html#aad0e42e8c895a1cedce5321c83a677b8">00032</a>         _ZONE_TYPES_DEF=[<span class="stringliteral">&quot;fortress&quot;</span>, <span class="stringliteral">&quot;flag&quot;</span>]
<a name="l00033"></a>00033 
<a name="l00034"></a>00034         <span class="comment">## @brief Eventgroup of this module</span>
<a name="l00035"></a>00035          <span class="comment"># @details Events used by this module:</span>
<a name="l00036"></a>00036          <span class="comment">#             &quot;Zone spawned&quot;: triggered when a zone is spawned.</span>
<a name="l00037"></a>00037          <span class="comment">#             &quot;Zone collapsed&quot;: triggered when a zone collapsed.</span>
<a name="l00038"></a>00038          <span class="comment">#             &quot;Zone renamed&quot;: triggered when the name of a zone changes</span>
<a name="l00039"></a><a class="code" href="namespace_zone.html#a2cf3edd088ca6482872ba018b81ef52a">00039</a>         events=Event.EventGroup(<span class="stringliteral">&quot;ZoneEvents&quot;</span>)
<a name="l00040"></a>00040         events.addEvent(Event.Event(<span class="stringliteral">&quot;Zone spawned&quot;</span>) )
<a name="l00041"></a>00041         events.addEvent(Event.Event(<span class="stringliteral">&quot;Zone collapsed&quot;</span>) )
<a name="l00042"></a>00042         events.addEvent(Event.Event(<span class="stringliteral">&quot;Zone renamed&quot;</span>) )
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">## @class Zone.Zone</span>
<a name="l00045"></a>00045  <span class="comment"># @brief A zone</span>
<a name="l00046"></a>00046  <span class="comment"># @details This class represents a zone. Zones can be spawned, collapsed, have a name, ...</span>
<a name="l00047"></a><a class="code" href="class_zone_1_1_zone.html">00047</a> <span class="keyword">class </span><a class="code" href="class_zone_1_1_zone.html" title="A zone.">Zone</a>(yaml.YAMLObject):
<a name="l00048"></a>00048         
<a name="l00049"></a>00049         <span class="comment">## @property __name</span>
<a name="l00050"></a>00050          <span class="comment"># @brief Used to store the name</span>
<a name="l00051"></a>00051          <span class="comment"># @details Internal variable for the name.</span>
<a name="l00052"></a>00052          <span class="comment"># @internal</span>
<a name="l00053"></a>00053          
<a name="l00054"></a>00054         <span class="comment">## @property color</span>
<a name="l00055"></a>00055          <span class="comment"># @brief The zone color</span>
<a name="l00056"></a>00056          <span class="comment"># @details The color of the zone is the tuple of r,g,b. The maximal values </span>
<a name="l00057"></a>00057          <span class="comment">#          for each r, g or b are 1.</span>
<a name="l00058"></a>00058         
<a name="l00059"></a>00059         <span class="comment">## @property position</span>
<a name="l00060"></a>00060          <span class="comment"># @brief The position of the zone.</span>
<a name="l00061"></a>00061          <span class="comment"># @details Tuple of x,y</span>
<a name="l00062"></a>00062         
<a name="l00063"></a>00063         <span class="comment">## @property radius</span>
<a name="l00064"></a>00064          <span class="comment"># @brief Zone radius</span>
<a name="l00065"></a>00065          <span class="comment"># @details The radius of the zone.</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067         <span class="comment">## @property __alive</span>
<a name="l00068"></a>00068          <span class="comment"># @brief Is the zone still alive?</span>
<a name="l00069"></a>00069          <span class="comment"># @details True if yes, False if no.</span>
<a name="l00070"></a>00070         
<a name="l00071"></a>00071         <span class="comment">## @property growth</span>
<a name="l00072"></a>00072          <span class="comment"># @brief The growth of the zone</span>
<a name="l00073"></a>00073          <span class="comment"># @details How much should the zone grow?</span>
<a name="l00074"></a>00074         
<a name="l00075"></a>00075         <span class="comment">## @property __type</span>
<a name="l00076"></a>00076          <span class="comment"># @brief The type of the zone</span>
<a name="l00077"></a>00077          <span class="comment"># @details Could be: win, death, ball, ballTeam, blast, deathTeam, koh, fortress, flag,</span>
<a name="l00078"></a>00078          <span class="comment">#                    rubber, sumo, target, teleport, zombie, zombieOwner</span>
<a name="l00079"></a>00079         
<a name="l00080"></a>00080         <span class="comment">## @property interactive</span>
<a name="l00081"></a>00081          <span class="comment"># @brief Should the zone bounce at walls?</span>
<a name="l00082"></a>00082          <span class="comment"># @details True if yes, False if no.</span>
<a name="l00083"></a>00083 
<a name="l00084"></a>00084         <span class="comment">## @property dir</span>
<a name="l00085"></a>00085          <span class="comment"># @brief Direction in which the zone should move.</span>
<a name="l00086"></a>00086          <span class="comment"># @details Tuple of xdir and ydir. 0,0 if the zone shouldn&#39;t move.</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088         <span class="comment">## @property target_size</span>
<a name="l00089"></a>00089          <span class="comment"># @brief max or min size of the zone</span>
<a name="l00090"></a>00090          <span class="comment"># @details Max or min radius of the zone, depends on the zone shrinks or expands.</span>
<a name="l00091"></a>00091 
<a name="l00092"></a>00092         <span class="comment">## @property teamnames</span>
<a name="l00093"></a>00093          <span class="comment"># @brief The team name(s) of the team(s) to pass to the zone before x and y.</span>
<a name="l00094"></a>00094          <span class="comment"># @details The escaped name of the teams or None when no teams should be passed.</span>
<a name="l00095"></a>00095         
<a name="l00096"></a>00096         <span class="comment">## @property settings</span>
<a name="l00097"></a>00097          <span class="comment"># @brief Zone type specific settings</span>
<a name="l00098"></a>00098          <span class="comment"># @details List of settings.</span>
<a name="l00099"></a>00099         
<a name="l00100"></a>00100         <span class="comment">## @property killteam</span>
<a name="l00101"></a>00101          <span class="comment"># @brief Kill the team when the zone collapses?</span>
<a name="l00102"></a>00102          <span class="comment"># @details True if yes, False otherwise.</span>
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         <span class="comment">## @property teleport_settings</span>
<a name="l00105"></a>00105          <span class="comment"># @brief Extra settings for teleport zones</span>
<a name="l00106"></a>00106          <span class="comment"># @details This setting is needed because the different types of zones has different</span>
<a name="l00107"></a>00107          <span class="comment">#          settings. The extra settings are allways at the end, except for teleport </span>
<a name="l00108"></a>00108          <span class="comment">#          zones. This settings are passed to SPAWN_ZONE at this position, but only</span>
<a name="l00109"></a>00109          <span class="comment">#          if the zone is a teleport zone.</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="comment">## @brief slots</span>
<a name="l00112"></a>00112          <span class="comment"># @internal</span>
<a name="l00113"></a>00113          <span class="comment"># @details See docs.python.org OOP Slots</span>
<a name="l00114"></a><a class="code" href="class_zone_1_1_zone.html#ad5bde96ea6dea6f68ee68d33a6c90850">00114</a>         __slots__=(<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;__name&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>, <span class="stringliteral">&quot;position&quot;</span>, <span class="stringliteral">&quot;radius&quot;</span>,<span class="stringliteral">&quot;__alive&quot;</span>, <span class="stringliteral">&quot;growth&quot;</span>,<span class="stringliteral">&quot;interactive&quot;</span>, 
<a name="l00115"></a>00115                   <span class="stringliteral">&quot;teamnames&quot;</span>, <span class="stringliteral">&quot;settings&quot;</span>, <span class="stringliteral">&quot;killteam&quot;</span>, <span class="stringliteral">&quot;target_size&quot;</span>, <span class="stringliteral">&quot;teleport_settings&quot;</span>,<span class="stringliteral">&quot;dir&quot;</span>,<span class="stringliteral">&quot;__type&quot;</span>)
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="comment">## @brief Yaml settings</span>
<a name="l00118"></a>00118          <span class="comment"># @details See http://pyyaml.org/wiki/PyYAMLDocumentation for details to the PyYaml library.</span>
<a name="l00119"></a>00119          <span class="comment"># @internal</span>
<a name="l00120"></a>00120          <span class="comment"># @cond</span>
<a name="l00121"></a>00121         yaml_tag=<span class="stringliteral">&quot;!zone&quot;</span>
<a name="l00122"></a>00122         <span class="comment">## @endcond</span>
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         <span class="comment">## @brief Which variables shouldn&#39;t be saved by object serializion?</span>
<a name="l00125"></a>00125          <span class="comment"># @details Variables to exclude in __get_state__</span>
<a name="l00126"></a>00126          <span class="comment"># @internal</span>
<a name="l00127"></a><a class="code" href="class_zone_1_1_zone.html#a3e925f38205ecb6e4c2bab8c79182573">00127</a>         __not_persistent=(<span class="stringliteral">&quot;__alive&quot;</span>, <span class="stringliteral">&quot;teamnames&quot;</span>)
<a name="l00128"></a>00128         
<a name="l00129"></a>00129         <span class="comment">## @brief Init function (Constructor)</span>
<a name="l00130"></a>00130          <span class="comment"># @details Inits a new Zone and adds properties.</span>
<a name="l00131"></a>00131          <span class="comment"># @param name The name of the zone</span>
<a name="l00132"></a>00132          <span class="comment"># @param position Tuple of the x and y coordinate of the position of the zone.</span>
<a name="l00133"></a>00133          <span class="comment"># @param radius Zone size (radius)</span>
<a name="l00134"></a>00134          <span class="comment"># @param growth \copybrief growth</span>
<a name="l00135"></a>00135          <span class="comment"># @param direction \copybrief dir</span>
<a name="l00136"></a>00136          <span class="comment"># @param interactive \copybrief interactive</span>
<a name="l00137"></a>00137          <span class="comment"># @param color Tuple of the r,g,b values of the color used for the zone,</span>
<a name="l00138"></a>00138          <span class="comment"># @param target_size \copybrief target_size</span>
<a name="l00139"></a>00139          <span class="comment"># @param type The zone type</span>
<a name="l00140"></a><a class="code" href="class_zone_1_1_zone.html#afe0e971765baa04ca770cbdc685efbb6">00140</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#afe0e971765baa04ca770cbdc685efbb6" title="Init function (Constructor).">__init__</a>(self, name, position=(0,0), radius=5, growth=0,direction=(0,0), 
<a name="l00141"></a><a class="code" href="class_zone_1_1_zone.html#a72ab1886c15120f42281d35955ab21b5">00141</a>                      interactive=<span class="keyword">False</span>, color=(0,0,1), target_size=-1,type=<span class="stringliteral">&quot;target&quot;</span> ):
<a name="l00142"></a><a class="code" href="class_zone_1_1_zone.html#ae30b162378f40661dfcb854ec7926bdb">00142</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a72ab1886c15120f42281d35955ab21b5" title="Used to store the name.">__name</a>=name 
<a name="l00143"></a><a class="code" href="class_zone_1_1_zone.html#a6ee5fd031ade8ecb6b2f41455ad309c4">00143</a>                 self.<a class="code" href="class_zone_1_1_zone.html#ae30b162378f40661dfcb854ec7926bdb" title="The position of the zone.">position</a>=position
<a name="l00144"></a><a class="code" href="class_zone_1_1_zone.html#a42d231813671766976464bbf2dfdf387">00144</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a6ee5fd031ade8ecb6b2f41455ad309c4" title="Zone radius.">radius</a>=radius
<a name="l00145"></a><a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7">00145</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a42d231813671766976464bbf2dfdf387" title="The growth of the zone.">growth</a>=growth
<a name="l00146"></a><a class="code" href="class_zone_1_1_zone.html#a0e94d3602835417fef9d1345cf1e739c">00146</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7" title="Is the zone still alive?">__alive</a>=<span class="keyword">False</span>
<a name="l00147"></a><a class="code" href="class_zone_1_1_zone.html#a574bf43b0f15767743c104faabbae973">00147</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a0e94d3602835417fef9d1345cf1e739c" title="The zone color.">color</a>=color
<a name="l00148"></a><a class="code" href="class_zone_1_1_zone.html#a20a50ae6ea7f05c4bb403ef0306ba83f">00148</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a574bf43b0f15767743c104faabbae973" title="Should the zone bounce at walls?">interactive</a>=interactive
<a name="l00149"></a><a class="code" href="class_zone_1_1_zone.html#a9962b673a138b53b1631158d18cf5279">00149</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a20a50ae6ea7f05c4bb403ef0306ba83f" title="Direction in which the zone should move.">dir</a>=direction
<a name="l00150"></a><a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91">00150</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a9962b673a138b53b1631158d18cf5279" title="max or min size of the zone">target_size</a>=target_size
<a name="l00151"></a><a class="code" href="class_zone_1_1_zone.html#a45db96faa826bf1e485c70da9c07d83e">00151</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>=[]
<a name="l00152"></a><a class="code" href="class_zone_1_1_zone.html#a57b65c53ff747cf9504c88ff37d7b9ee">00152</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a45db96faa826bf1e485c70da9c07d83e" title="Kill the team when the zone collapses?">killteam</a>=<span class="keyword">False</span>
<a name="l00153"></a><a class="code" href="class_zone_1_1_zone.html#a2b9ae272876347626e25ead4d48f9a97">00153</a>                 self.<a class="code" href="class_zone_1_1_zone.html#a57b65c53ff747cf9504c88ff37d7b9ee" title="Zone type specific settings.">settings</a>=[]
<a name="l00154"></a>00154                 self.<a class="code" href="class_zone_1_1_zone.html#a2b9ae272876347626e25ead4d48f9a97" title="Extra settings for teleport zones.">teleport_settings</a>=[]
<a name="l00155"></a>00155                 self.<a class="code" href="class_zone_1_1_zone.html#ae86cd40bd98448e74ed206e515a1f5da" title="Sets the zone type.">setType</a>(type)
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         <span class="comment">## @brief Spawns the zone</span>
<a name="l00158"></a>00158          <span class="comment"># @details Spawns the zone and sets alive to True</span>
<a name="l00159"></a>00159          <span class="comment"># @param delay Spawn after delay secounds.</span>
<a name="l00160"></a>00160          <span class="comment"># @note This triggers the event &quot;Zone spawned&quot;</span>
<a name="l00161"></a><a class="code" href="class_zone_1_1_zone.html#a6197bd3a82e33df84c7a24a2bd698516">00161</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#a6197bd3a82e33df84c7a24a2bd698516" title="Spawns the zone.">spawn</a>(self, delay=0):
<a name="l00162"></a>00162                 <span class="keywordflow">if</span> delay != 0:
<a name="l00163"></a>00163                         <span class="keyword">def </span>run(delay, func):
<a name="l00164"></a>00164                                 time.sleep(delay)
<a name="l00165"></a>00165                                 func()
<a name="l00166"></a>00166                         t=Thread(<span class="keywordtype">None</span>, run, args=(delay, self.<a class="code" href="class_zone_1_1_zone.html#a6197bd3a82e33df84c7a24a2bd698516" title="Spawns the zone.">spawn</a>))
<a name="l00167"></a>00167                         t.start()
<a name="l00168"></a>00168                         <span class="keywordflow">return</span>
<a name="l00169"></a>00169                 name=<span class="stringliteral">&quot;&quot;</span>
<a name="l00170"></a>00170                 command=<span class="stringliteral">&quot;&quot;</span>
<a name="l00171"></a>00171                 teams=list()
<a name="l00172"></a>00172                 command=str(<span class="stringliteral">&quot;SPAWN_ZONE {name} {type} {teams} {x} {y} {radius} {grow} {dirx} {diry} &quot;</span>
<a name="l00173"></a>00173                         <span class="stringliteral">&quot;{tele_settings} {ztss} {intera} {r} {g} {b} {ts}&quot;</span>)
<a name="l00174"></a>00174                 <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a> != <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>.strip()!=<span class="stringliteral">&quot;&quot;</span>:
<a name="l00175"></a>00175                         name=<span class="stringliteral">&quot;n &quot;</span>+self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>.replace(<span class="stringliteral">&quot; &quot;</span>,<span class="stringliteral">&quot;_&quot;</span>)
<a name="l00176"></a>00176                 <span class="keywordflow">if</span> len(self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>)!=0:
<a name="l00177"></a>00177                         <span class="keywordflow">for</span> team <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>:
<a name="l00178"></a>00178                                 <span class="keywordflow">if</span> team <span class="keywordflow">not</span> <span class="keywordflow">in</span> Team.teams:
<a name="l00179"></a>00179                                         <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a> != <span class="keywordtype">None</span>:
<a name="l00180"></a>00180                                                 log.error(<span class="stringliteral">&quot;Team assigned with zone „&quot;</span>+self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>+<span class="stringliteral">&quot;“ doesn&#39;t exist.&quot;</span>)
<a name="l00181"></a>00181                                         <span class="keywordflow">else</span>:
<a name="l00182"></a>00182                                                 log.error(<span class="stringliteral">&quot;Team assigned with zone doesn&#39;t exist&quot;</span>)
<a name="l00183"></a>00183                                 <span class="keywordflow">else</span>:
<a name="l00184"></a>00184                                         <span class="keywordflow">if</span> team == <span class="stringliteral">&quot;ai&quot;</span>:
<a name="l00185"></a>00185                                                 team=<span class="stringliteral">&quot;ai_team&quot;</span>
<a name="l00186"></a>00186                                         teams=teams+[team]
<a name="l00187"></a>00187                 teams=<span class="stringliteral">&quot; &quot;</span>.join(teams)
<a name="l00188"></a>00188                 tele_settings=<span class="stringliteral">&quot;&quot;</span>
<a name="l00189"></a><a class="code" href="class_zone_1_1_zone.html#a5164f57edacb2b3a7b3dfca3ba949139">00189</a>                 <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#a5164f57edacb2b3a7b3dfca3ba949139" title="The type of the zone.">__type</a>==<span class="stringliteral">&quot;teleport&quot;</span>:
<a name="l00190"></a>00190                         tele_settings=<span class="stringliteral">&quot; &quot;</span>.join(self.<a class="code" href="class_zone_1_1_zone.html#a2b9ae272876347626e25ead4d48f9a97" title="Extra settings for teleport zones.">teleport_settings</a>)
<a name="l00191"></a>00191                 settings=(<span class="stringliteral">&quot; &quot;</span>).join(self.<a class="code" href="class_zone_1_1_zone.html#a57b65c53ff747cf9504c88ff37d7b9ee" title="Zone type specific settings.">settings</a>)
<a name="l00192"></a>00192                 x,y=self.<a class="code" href="class_zone_1_1_zone.html#ae30b162378f40661dfcb854ec7926bdb" title="The position of the zone.">position</a>
<a name="l00193"></a>00193                 r,g,b=self.<a class="code" href="class_zone_1_1_zone.html#a0e94d3602835417fef9d1345cf1e739c" title="The zone color.">color</a>
<a name="l00194"></a>00194                 dirx,diry=self.<a class="code" href="class_zone_1_1_zone.html#a20a50ae6ea7f05c4bb403ef0306ba83f" title="Direction in which the zone should move.">dir</a>
<a name="l00195"></a>00195                 settings=<span class="stringliteral">&quot; &quot;</span>.join(self.<a class="code" href="class_zone_1_1_zone.html#a57b65c53ff747cf9504c88ff37d7b9ee" title="Zone type specific settings.">settings</a>)
<a name="l00196"></a>00196                 SendCommand(
<a name="l00197"></a>00197                             command.format(name=name, type=self.<a class="code" href="class_zone_1_1_zone.html#a5164f57edacb2b3a7b3dfca3ba949139" title="The type of the zone.">__type</a>, teams=teams, x=x, y=y, 
<a name="l00198"></a>00198                             radius=self.<a class="code" href="class_zone_1_1_zone.html#a6ee5fd031ade8ecb6b2f41455ad309c4" title="Zone radius.">radius</a>, grow=self.<a class="code" href="class_zone_1_1_zone.html#a42d231813671766976464bbf2dfdf387" title="The growth of the zone.">growth</a>, dirx=dirx, diry=diry, 
<a name="l00199"></a>00199                             intera=self.<a class="code" href="class_zone_1_1_zone.html#a574bf43b0f15767743c104faabbae973" title="Should the zone bounce at walls?">interactive</a>, r=r,g=g,b=b, ts=self.<a class="code" href="class_zone_1_1_zone.html#a9962b673a138b53b1631158d18cf5279" title="max or min size of the zone">target_size</a>, 
<a name="l00200"></a>00200                             tele_settings=tele_settings,ztss=settings) 
<a name="l00201"></a>00201                            )
<a name="l00202"></a>00202                 self.<a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7" title="Is the zone still alive?">__alive</a>=<span class="keyword">True</span>
<a name="l00203"></a>00203                 events.triggerEvent(<span class="stringliteral">&quot;Zone spawned&quot;</span>, self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>)
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> name == <span class="stringliteral">&quot;&quot;</span>:
<a name="l00205"></a>00205                         name=<span class="stringliteral">&quot;Unnamed&quot;</span>
<a name="l00206"></a>00206                 log.info(<span class="stringliteral">&quot;Zone „&quot;</span>+name.replace(<span class="stringliteral">&quot;n &quot;</span>,<span class="stringliteral">&quot;&quot;</span>)+<span class="stringliteral">&quot;“ spawned.&quot;</span>)
<a name="l00207"></a>00207         <span class="comment">## @brief Collapses the zone</span>
<a name="l00208"></a>00208          <span class="comment"># @details Collapses the zone and sets alive to false</span>
<a name="l00209"></a>00209          <span class="comment"># @warning If the zone name is None, all zones with no name are collapsed.</span>
<a name="l00210"></a>00210          <span class="comment"># @note This triggers the event &quot;Zone collapsed&quot;</span>
<a name="l00211"></a><a class="code" href="class_zone_1_1_zone.html#a82cd5417c0fd6dc0cb7d1b8a3399e174">00211</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#a82cd5417c0fd6dc0cb7d1b8a3399e174" title="Collapses the zone.">collapse</a>(self):
<a name="l00212"></a>00212                 name=<span class="stringliteral">&quot;&quot;</span>
<a name="l00213"></a>00213                 <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a> != <span class="keywordtype">None</span>:
<a name="l00214"></a>00214                         name=self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>.replace(<span class="stringliteral">&quot; &quot;</span>,<span class="stringliteral">&quot;_&quot;</span>)
<a name="l00215"></a>00215                 SendCommand(<span class="stringliteral">&quot;COLLAPSE_ZONE {0}&quot;</span>.format(name) )
<a name="l00216"></a>00216                 <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#a45db96faa826bf1e485c70da9c07d83e" title="Kill the team when the zone collapses?">killteam</a> <span class="keywordflow">and</span> len(self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>)!=0 <span class="keywordflow">and</span> len(self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>)==1:
<a name="l00217"></a>00217                         <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>[0] <span class="keywordflow">not</span> <span class="keywordflow">in</span> Team.teams:
<a name="l00218"></a>00218                                 <span class="keywordflow">if</span> self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a> != <span class="keywordtype">None</span>:
<a name="l00219"></a>00219                                         log.error(<span class="stringliteral">&quot;Team assigned with zone „&quot;</span>+self.<a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>+<span class="stringliteral">&quot;“ doesn&#39;t exist.&quot;</span>)
<a name="l00220"></a>00220                                 <span class="keywordflow">else</span>:
<a name="l00221"></a>00221                                         log.error(<span class="stringliteral">&quot;Team assigned with zone doesn&#39;t exist&quot;</span>)
<a name="l00222"></a>00222                         <span class="keywordflow">else</span>:
<a name="l00223"></a>00223                                 Team.teams[self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>[0]].kill()
<a name="l00224"></a>00224                 self.<a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7" title="Is the zone still alive?">__alive</a>=<span class="keyword">False</span>
<a name="l00225"></a>00225                 events.triggerEvent(<span class="stringliteral">&quot;Zone collapsed&quot;</span>)
<a name="l00226"></a>00226                 <span class="keywordflow">if</span> name == <span class="stringliteral">&quot;&quot;</span>:
<a name="l00227"></a>00227                         name=<span class="stringliteral">&quot;Unnamed&quot;</span>
<a name="l00228"></a>00228                 log.info(<span class="stringliteral">&quot;Zone „&quot;</span>+name+<span class="stringliteral">&quot;“ collapsed.&quot;</span>)
<a name="l00229"></a>00229         
<a name="l00230"></a>00230         <span class="comment">## @brief Gets the zone name</span>
<a name="l00231"></a>00231          <span class="comment"># @return The zone name or None if the zone is unnamed.</span>
<a name="l00232"></a>00232         @property
<a name="l00233"></a><a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215">00233</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#acbb02f4e05a741d0f0817f3f7a72b215" title="Gets the zone name.">name</a>(self):
<a name="l00234"></a>00234                 <span class="keywordflow">return</span> self.<a class="code" href="class_zone_1_1_zone.html#a72ab1886c15120f42281d35955ab21b5" title="Used to store the name.">__name</a>
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="comment">## @brief Sets the zone name</span>
<a name="l00237"></a>00237          <span class="comment"># @param newname The new name of the zone or None if the zone should be unnamed.</span>
<a name="l00238"></a>00238          <span class="comment"># @note This triggers the event &quot;Zone renamed&quot;</span>
<a name="l00239"></a>00239         @name.setter
<a name="l00240"></a><a class="code" href="class_zone_1_1_zone.html#a01a15c4548a4e2675890cec3b6172beb">00240</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#a01a15c4548a4e2675890cec3b6172beb" title="Sets the zone name.">setName</a>(self, newname):
<a name="l00241"></a>00241                 self.<a class="code" href="class_zone_1_1_zone.html#a72ab1886c15120f42281d35955ab21b5" title="Used to store the name.">__name</a>=newname
<a name="l00242"></a>00242                 events.triggerEvent(<span class="stringliteral">&quot;Zone renamed&quot;</span>)
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         <span class="comment">## @brief Returns the alive state of the zone</span>
<a name="l00245"></a>00245          <span class="comment"># @return True if the zone is alive, False otherwise.</span>
<a name="l00246"></a><a class="code" href="class_zone_1_1_zone.html#af99fbbc555e6f93d62126c17ae9a8052">00246</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#af99fbbc555e6f93d62126c17ae9a8052" title="Returns the alive state of the zone.">isAlive</a>(self):
<a name="l00247"></a>00247                 <span class="keywordflow">return</span> self.<a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7" title="Is the zone still alive?">__alive</a>
<a name="l00248"></a>00248 
<a name="l00249"></a>00249         <span class="comment">## @brief Sets the zone type</span>
<a name="l00250"></a>00250          <span class="comment"># @details For more information about zone types go to </span>
<a name="l00251"></a>00251          <span class="comment">#          http://crazy-tronners.com/wiki/index.php/Settings#type</span>
<a name="l00252"></a>00252          <span class="comment"># @param ztype The name of the zone type.</span>
<a name="l00253"></a>00253          <span class="comment"># @exception ValueError Raised if the zone type doesn&#39;t exist.</span>
<a name="l00254"></a><a class="code" href="class_zone_1_1_zone.html#ae86cd40bd98448e74ed206e515a1f5da">00254</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#ae86cd40bd98448e74ed206e515a1f5da" title="Sets the zone type.">setType</a>(self, ztype):
<a name="l00255"></a>00255                 <span class="keywordflow">if</span> ztype <span class="keywordflow">not</span> <span class="keywordflow">in</span> _ZONE_TYPES:
<a name="l00256"></a>00256                         <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Wrong zone type.&quot;</span>,0)
<a name="l00257"></a>00257                 self.<a class="code" href="class_zone_1_1_zone.html#a5164f57edacb2b3a7b3dfca3ba949139" title="The type of the zone.">__type</a>=ztype
<a name="l00258"></a>00258 
<a name="l00259"></a>00259         <span class="comment">## @brief Returns current object state.</span>
<a name="l00260"></a>00260          <span class="comment"># @details Used by pickle and other serializing modules.</span>
<a name="l00261"></a>00261          <span class="comment"># @return A dictionary of the current object state</span>
<a name="l00262"></a><a class="code" href="class_zone_1_1_zone.html#a5a7b3f0b78ec9afe8a4bb61f3b7b3dc6">00262</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#a5a7b3f0b78ec9afe8a4bb61f3b7b3dc6" title="Returns current object state.">__getstate__</a>(self):
<a name="l00263"></a>00263                 __state=dict()
<a name="l00264"></a>00264                 <span class="keywordflow">for</span> var <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#ad5bde96ea6dea6f68ee68d33a6c90850" title="slots">__slots__</a>:
<a name="l00265"></a>00265                         <span class="keywordflow">if</span> var <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#a3e925f38205ecb6e4c2bab8c79182573" title="Yaml settings.">__not_persistent</a>:
<a name="l00266"></a>00266                                 varname=var
<a name="l00267"></a>00267                                 settingsname=var
<a name="l00268"></a>00268                                 <span class="keywordflow">if</span> var.startswith(<span class="stringliteral">&quot;__&quot;</span>):
<a name="l00269"></a>00269                                         varname=var.replace(<span class="stringliteral">&quot;__&quot;</span>,<span class="stringliteral">&quot;_Zone__&quot;</span>,1)
<a name="l00270"></a>00270                                         settingsname=var.replace(<span class="stringliteral">&quot;__&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,1)
<a name="l00271"></a>00271                                 <span class="keywordflow">if</span> (hasattr(self, settingsname) <span class="keywordflow">and</span> settingsname!=varname) <span class="keywordflow">or</span> <span class="keywordflow">not</span> hasattr(self, varname):
<a name="l00272"></a>00272                                         <span class="keywordflow">continue</span> <span class="comment"># Ignore private variables if a public one with the same name exists.</span>
<a name="l00273"></a>00273                                 __state[settingsname]=getattr(self, varname)
<a name="l00274"></a>00274                 <span class="keywordflow">return</span> __state
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         <span class="comment">## @brief Sets the current object state</span>
<a name="l00277"></a>00277          <span class="comment"># @details Used by pickle and other serializing modules.</span>
<a name="l00278"></a>00278          <span class="comment"># @param state The state to which to set the current object state.</span>
<a name="l00279"></a><a class="code" href="class_zone_1_1_zone.html#a5de944ddd9b301373881c3e867ddae8b">00279</a>         <span class="keyword">def </span><a class="code" href="class_zone_1_1_zone.html#a5de944ddd9b301373881c3e867ddae8b" title="Sets the current object state.">__setstate__</a>(self, state):
<a name="l00280"></a>00280                 <span class="keywordflow">for</span> var, value <span class="keywordflow">in</span> state.items():
<a name="l00281"></a>00281                         <span class="keywordflow">if</span> <span class="keywordflow">not</span> var <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#ad5bde96ea6dea6f68ee68d33a6c90850" title="slots">__slots__</a>:
<a name="l00282"></a>00282                                 var=<span class="stringliteral">&quot;__&quot;</span>+var
<a name="l00283"></a>00283                                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> var <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#ad5bde96ea6dea6f68ee68d33a6c90850" title="slots">__slots__</a>:
<a name="l00284"></a>00284                                         <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Error: Invalid state (var &quot;</span>+str(var)+<span class="stringliteral">&quot; doesn&#39;t exist.)&quot;</span>)
<a name="l00285"></a>00285                                 <span class="keywordflow">else</span>:
<a name="l00286"></a>00286                                         var=<span class="stringliteral">&quot;_Zone&quot;</span>+var
<a name="l00287"></a>00287                         <span class="keywordflow">try</span>:
<a name="l00288"></a>00288                                 setattr(self, var, value)
<a name="l00289"></a>00289                         <span class="keywordflow">except</span> AttributeError:
<a name="l00290"></a>00290                                 <span class="keywordflow">if</span> <span class="stringliteral">&quot;__&quot;</span>+var <span class="keywordflow">in</span> self.<a class="code" href="class_zone_1_1_zone.html#ad5bde96ea6dea6f68ee68d33a6c90850" title="slots">__slots__</a>:
<a name="l00291"></a>00291                                         setattr(self, <span class="stringliteral">&quot;_Zone__&quot;</span>+var,value)
<a name="l00292"></a>00292                 self.<a class="code" href="class_zone_1_1_zone.html#a1c4e31d1327ad4d7a2c31a2b7fcde5e7" title="Is the zone still alive?">__alive</a>=<span class="keyword">False</span>
<a name="l00293"></a>00293                 self.<a class="code" href="class_zone_1_1_zone.html#a0f3f8429ae8a37672f700da3f2805a91" title="The team name(s) of the team(s) to pass to the zone before x and y.">teamnames</a>=list()
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="comment">## @brief Enables logging</span>
<a name="l00296"></a>00296  <span class="comment"># @details This function enables logging for this module.</span>
<a name="l00297"></a>00297  <span class="comment"># @param h The handler used for logging</span>
<a name="l00298"></a>00298  <span class="comment"># @param f The formatter used for logging</span>
<a name="l00299"></a>00299  <span class="comment"># @param level The logging level </span>
<a name="l00300"></a><a class="code" href="namespace_zone.html#aaa40a627f781a072131be03ac8e08328">00300</a> <span class="keyword">def </span><a class="code" href="namespace_zone.html#aaa40a627f781a072131be03ac8e08328" title="Enables logging.">enableLogging</a>(level=logging.DEBUG, h=None,f=None):
<a name="l00301"></a>00301         <span class="keyword">global</span> log
<a name="l00302"></a>00302         log.setLevel(level)
<a name="l00303"></a>00303         <span class="keywordflow">if</span> <span class="keywordflow">not</span> h:
<a name="l00304"></a>00304                 h=logging.StreamHandler()
<a name="l00305"></a>00305                 h.setLevel(level)
<a name="l00306"></a>00306         <span class="keywordflow">if</span> <span class="keywordflow">not</span> f:
<a name="l00307"></a>00307                 f=logging.Formatter(<span class="stringliteral">&quot;[%(name)s] (%(asctime)s) %(levelname)s: %(message)s&quot;</span>)
<a name="l00308"></a>00308         h.setFormatter(f)
<a name="l00309"></a>00309         <span class="keywordflow">for</span> handler <span class="keywordflow">in</span> log.handlers:
<a name="l00310"></a>00310                 <span class="keywordflow">if</span> type(handler)==type(h):
<a name="l00311"></a>00311                         log.removeHandler(handler)
<a name="l00312"></a>00312         log.addHandler(h)
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Jul 5 2011 16:01:24 for Armagetron MultiModeScript by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
